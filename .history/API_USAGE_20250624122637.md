# REST API ì—°ë™ ê°€ì´ë“œ

ì´ í”„ë¡œì íŠ¸ëŠ” ë°±ì—”ë“œ APIì™€ì˜ ì—°ë™ì„ ìœ„í•œ ê¸°ë³¸ êµ¬ì¡°ê°€ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤.

## ğŸ“ íŒŒì¼ êµ¬ì¡°

```
src/
â”œâ”€â”€ types/
â”‚   â””â”€â”€ api.ts              # API ì‘ë‹µ íƒ€ì… ì •ì˜
â”œâ”€â”€ lib/
â”‚   â”œâ”€â”€ api.ts              # Axios ì¸ìŠ¤í„´ìŠ¤ ë° ApiClient í´ë˜ìŠ¤
â”‚   â””â”€â”€ auth.ts             # JWT í† í° ê´€ë¦¬ ìœ í‹¸ë¦¬í‹°
â”œâ”€â”€ services/
â”‚   â”œâ”€â”€ authService.ts      # ì¸ì¦ ê´€ë ¨ API ì„œë¹„ìŠ¤
â”‚   â””â”€â”€ exampleService.ts   # ì‚¬ìš© ì˜ˆì‹œ ì„œë¹„ìŠ¤ë“¤
â””â”€â”€ hooks/
    â””â”€â”€ useAuth.ts          # ì¸ì¦ ìƒíƒœ ê´€ë¦¬ í›…
```

## ğŸ”§ í™˜ê²½ ì„¤ì •

`.env.local` íŒŒì¼ì„ ìƒì„±í•˜ê³  ë‹¤ìŒ ë‚´ìš©ì„ ì¶”ê°€í•˜ì„¸ìš”:

```env
# API ê¸°ë³¸ URL
NEXT_PUBLIC_API_BASE_URL=http://localhost:3001/api

# JWT í† í° ë§Œë£Œ ì‹œê°„ (ì„ íƒì‚¬í•­)
NEXT_PUBLIC_TOKEN_EXPIRY=7d
```

## ğŸ—ï¸ ë°±ì—”ë“œ ì‘ë‹µ í˜•ì‹

ëª¨ë“  API ì‘ë‹µì€ ë‹¤ìŒ í˜•ì‹ì„ ë”°ë¦…ë‹ˆë‹¤:

```typescript
interface ApiResponse<T> {
  success?: boolean;
  message?: string;
  data?: T;
  error?: string;
}
```

## ğŸ” ì¸ì¦ êµ¬ë¶„

### 1. ë¹„ë¡œê·¸ì¸ API (ê³µê°œ API)

```typescript
import ApiClient from "@/lib/api";

// GET ìš”ì²­
const response = await ApiClient.get<PostData>("/posts");

// POST ìš”ì²­
const response = await ApiClient.post<PostData>("/posts", postData);
```

### 2. ë¡œê·¸ì¸ API (ì¸ì¦ í•„ìš”)

```typescript
import ApiClient from "@/lib/api";

// GET ìš”ì²­ (JWT í† í° ìë™ í¬í•¨)
const response = await ApiClient.getPrivate<UserData>("/users/profile");

// POST ìš”ì²­ (JWT í† í° ìë™ í¬í•¨)
const response = await ApiClient.postPrivate<PostData>("/posts", postData);

// PUT, DELETE, PATCH ë“±ë„ ë™ì¼í•˜ê²Œ ì‚¬ìš©
const response = await ApiClient.putPrivate<PostData>(
  `/posts/${id}`,
  updateData
);
const response = await ApiClient.deletePrivate(`/posts/${id}`);
const response = await ApiClient.patchPrivate<PostData>(
  `/posts/${id}`,
  patchData
);
```

## ğŸ“ ì‚¬ìš© ì˜ˆì‹œ

### 1. ì¸ì¦ ê´€ë ¨

```typescript
import { useAuth } from "@/hooks/useAuth";

function LoginComponent() {
  const { login, logout, isLoggedIn, user, isLoading } = useAuth();

  const handleLogin = async () => {
    const response = await login({
      email: "user@example.com",
      password: "password123",
    });

    if (response.success) {
      console.log("ë¡œê·¸ì¸ ì„±ê³µ:", response.data);
    } else {
      console.error("ë¡œê·¸ì¸ ì‹¤íŒ¨:", response.error);
    }
  };

  const handleLogout = async () => {
    await logout();
  };

  if (isLoading) return <div>ë¡œë”© ì¤‘...</div>;

  return (
    <div>
      {isLoggedIn ? (
        <div>
          <p>í™˜ì˜í•©ë‹ˆë‹¤, {user?.name}ë‹˜!</p>
          <button onClick={handleLogout}>ë¡œê·¸ì•„ì›ƒ</button>
        </div>
      ) : (
        <button onClick={handleLogin}>ë¡œê·¸ì¸</button>
      )}
    </div>
  );
}
```

### 2. ê²Œì‹œê¸€ ê´€ë¦¬

```typescript
import { PostService } from "@/services/exampleService";

// ê²Œì‹œê¸€ ëª©ë¡ ì¡°íšŒ (ê³µê°œ)
const posts = await PostService.getPosts(1, 10);
if (posts.success) {
  console.log("ê²Œì‹œê¸€ ëª©ë¡:", posts.data);
}

// ê²Œì‹œê¸€ ìƒì„± (ì¸ì¦ í•„ìš”)
const newPost = await PostService.createPost({
  title: "ìƒˆ ê²Œì‹œê¸€",
  content: "ê²Œì‹œê¸€ ë‚´ìš©",
});
if (newPost.success) {
  console.log("ê²Œì‹œê¸€ ìƒì„± ì„±ê³µ:", newPost.data);
}

// ê²Œì‹œê¸€ ìˆ˜ì • (ì¸ì¦ í•„ìš”)
const updatedPost = await PostService.updatePost("post-id", {
  title: "ìˆ˜ì •ëœ ì œëª©",
});

// ê²Œì‹œê¸€ ì‚­ì œ (ì¸ì¦ í•„ìš”)
const deleteResult = await PostService.deletePost("post-id");
```

### 3. íŒŒì¼ ì—…ë¡œë“œ

```typescript
import { FileService } from "@/services/exampleService";

// íŒŒì¼ ì—…ë¡œë“œ (ì¸ì¦ í•„ìš”)
const handleFileUpload = async (file: File) => {
  const response = await FileService.uploadFile(file);

  if (response.success) {
    console.log("ì—…ë¡œë“œ ì„±ê³µ:", response.data?.url);
  } else {
    console.error("ì—…ë¡œë“œ ì‹¤íŒ¨:", response.error);
  }
};
```

### 4. ì—ëŸ¬ ì²˜ë¦¬

```typescript
import ApiClient from "@/lib/api";

const fetchData = async () => {
  const response = await ApiClient.getPrivate<UserData>("/users/profile");

  if (response.success) {
    // ì„±ê³µ ì²˜ë¦¬
    console.log("ì‚¬ìš©ì ë°ì´í„°:", response.data);
  } else {
    // ì—ëŸ¬ ì²˜ë¦¬
    console.error("ì—ëŸ¬ ë©”ì‹œì§€:", response.message);
    console.error("ì—ëŸ¬ ìƒì„¸:", response.error);
  }
};
```

## ğŸ”„ í† í° ê´€ë¦¬

JWT í† í°ì€ ìë™ìœ¼ë¡œ ê´€ë¦¬ë©ë‹ˆë‹¤:

- ë¡œê·¸ì¸ ì„±ê³µ ì‹œ í† í°ì´ localStorageì— ìë™ ì €ì¥
- ì¸ì¦ì´ í•„ìš”í•œ API í˜¸ì¶œ ì‹œ í† í°ì´ ìë™ìœ¼ë¡œ í—¤ë”ì— í¬í•¨
- í† í° ë§Œë£Œ ì‹œ ìë™ìœ¼ë¡œ ë¡œê·¸ì¸ í˜ì´ì§€ë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸
- ë¡œê·¸ì•„ì›ƒ ì‹œ í† í° ìë™ ì‚­ì œ

## ğŸ› ï¸ ìƒˆë¡œìš´ ì„œë¹„ìŠ¤ ì¶”ê°€ ë°©ë²•

1. `src/services/` í´ë”ì— ìƒˆ ì„œë¹„ìŠ¤ íŒŒì¼ ìƒì„±
2. `ApiClient`ë¥¼ importí•˜ì—¬ ì‚¬ìš©
3. ê³µê°œ APIëŠ” `ApiClient.get`, `ApiClient.post` ë“± ì‚¬ìš©
4. ì¸ì¦ APIëŠ” `ApiClient.getPrivate`, `ApiClient.postPrivate` ë“± ì‚¬ìš©

```typescript
// src/services/myService.ts
import ApiClient from "@/lib/api";
import { ApiResponse } from "@/types/api";

export class MyService {
  static async getPublicData(): Promise<ApiResponse<MyData>> {
    return await ApiClient.get<MyData>("/my-endpoint");
  }

  static async getPrivateData(): Promise<ApiResponse<MyData>> {
    return await ApiClient.getPrivate<MyData>("/my-private-endpoint");
  }
}
```

## ğŸš¨ ì£¼ì˜ì‚¬í•­

1. í™˜ê²½ë³€ìˆ˜ `NEXT_PUBLIC_API_BASE_URL`ì„ ë°˜ë“œì‹œ ì„¤ì •í•˜ì„¸ìš”
2. ë°±ì—”ë“œ APIê°€ CORSë¥¼ í—ˆìš©í•˜ë„ë¡ ì„¤ì •ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸í•˜ì„¸ìš”
3. JWT í† í°ì˜ ë§Œë£Œ ì‹œê°„ì„ ë°±ì—”ë“œì™€ ì¼ì¹˜ì‹œí‚¤ì„¸ìš”
4. í”„ë¡œë•ì…˜ í™˜ê²½ì—ì„œëŠ” HTTPSë¥¼ ì‚¬ìš©í•˜ì„¸ìš”
